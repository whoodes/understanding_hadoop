Test Results
------------
1 mapper
1 reducer

mapreduce.task.io.sort.mb = 1
mapreduce.map.sort.spill.percent = 0.5

NUM_CHARACTERS_PER_WORD = 1
TEXT_WRITABLE_LEN_SIZE = 1
INT_WRITABLE_SIZE = 4

KEY_VALUE_SIZE = NUM_CHARACTERS_PER_WORD + TEXT_WRITABLE_LEN_SIZE + INT_WRITABLE_SIZE

KEY_LEN_SIZE = 1
VALUE_LEN_SIZE = 1

KEY_VALUE_META_DATA_SIZE = KEY_LEN_SIZE + VALUE_LEN_SIZE

SPILL_FILE_TRAILING_BYTES = 6

NUM_WORDS_LIST = [23750, 23875, 24000, 27500, 35000, 50000]

Result(map_output_bytes=142500, expected_map_output_bytes=142500, materialized_bytes=190006, expected_materialized_bytes=190006, output_to_materialized_ratio=1.3333754385964913, num_spill_files=1)
Result(map_output_bytes=143250, expected_map_output_bytes=143250, materialized_bytes=191006, expected_materialized_bytes=191006, output_to_materialized_ratio=1.3333752181500873, num_spill_files=2)
Result(map_output_bytes=144000, expected_map_output_bytes=144000, materialized_bytes=192006, expected_materialized_bytes=192006, output_to_materialized_ratio=1.333375, num_spill_files=2)
Result(map_output_bytes=165000, expected_map_output_bytes=165000, materialized_bytes=220006, expected_materialized_bytes=220006, output_to_materialized_ratio=1.3333696969696969, num_spill_files=2)
Result(map_output_bytes=210000, expected_map_output_bytes=210000, materialized_bytes=280006, expected_materialized_bytes=280006, output_to_materialized_ratio=1.3333619047619047, num_spill_files=2)
Result(map_output_bytes=300000, expected_map_output_bytes=300000, materialized_bytes=400006, expected_materialized_bytes=400006, output_to_materialized_ratio=1.3333533333333334, num_spill_files=3)

Test Results
------------
1 mapper
1 reducer

mapreduce.task.io.sort.mb = 1
mapreduce.map.sort.spill.percent = 0.5

NUM_CHARACTERS_PER_WORD = 128
TEXT_WRITABLE_LEN_SIZE = 2
INT_WRITABLE_SIZE = 4

KEY_VALUE_SIZE = NUM_CHARACTERS_PER_WORD + TEXT_WRITABLE_LEN_SIZE + INT_WRITABLE_SIZE

KEY_LEN_SIZE = 2
VALUE_LEN_SIZE = 1

KEY_VALUE_META_DATA_SIZE = KEY_LEN_SIZE + VALUE_LEN_SIZE

SPILL_FILE_TRAILING_BYTES = 6

NUM_WORDS_LIST = [100, 500, 1000, 5000, 10000, 50000, 100000]

Result(map_output_bytes=13400, expected_map_output_bytes=13400, materialized_bytes=13706, expected_materialized_bytes=13706, output_to_materialized_ratio=1.0228358208955224, num_spill_files=1)
Result(map_output_bytes=67000, expected_map_output_bytes=67000, materialized_bytes=68506, expected_materialized_bytes=68506, output_to_materialized_ratio=1.0224776119402985, num_spill_files=1)
Result(map_output_bytes=134000, expected_map_output_bytes=134000, materialized_bytes=137006, expected_materialized_bytes=137006, output_to_materialized_ratio=1.0224328358208956, num_spill_files=1)
Result(map_output_bytes=670000, expected_map_output_bytes=670000, materialized_bytes=685006, expected_materialized_bytes=685006, output_to_materialized_ratio=1.0223970149253732, num_spill_files=2)
Result(map_output_bytes=1340000, expected_map_output_bytes=1340000, materialized_bytes=1370006, expected_materialized_bytes=1370006, output_to_materialized_ratio=1.0223925373134328, num_spill_files=3)
Result(map_output_bytes=6700000, expected_map_output_bytes=6700000, materialized_bytes=6850006, expected_materialized_bytes=6850006, output_to_materialized_ratio=1.0223889552238805, num_spill_files=15)
Result(map_output_bytes=13400000, expected_map_output_bytes=13400000, materialized_bytes=13700006, expected_materialized_bytes=13700006, output_to_materialized_ratio=1.0223885074626866, num_spill_files=29)
